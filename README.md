# infoteks-java-qa
Тестовое задание на позицию стажёра по направлению "Автотестирование Java" в Инфотекс.

## Сборка ftp-клиента
Пререквизиты: bash.

Для сборки jar-архива выполните в терминале `./pack.sh`. Если bash в вашей системе установлен не по пути `/bin/bash`, вместо этого выполните 
`<команда для вызова вашего bash> pack.sh`.

Для другого командного интерпретатора (в том числе CMD) можно выполнить аналогичные команды сборки вручную, 
но работоспособность проекта в таких ситуациях не проверена.

## Работа с клиентом
В корне репозитория лежит jar-файл клиента app.jar.

Запустите собранный jar-файл клиента следующим образом, передав на вход три аргумента командной строки:
```
java -jar app.jar <username> <password> <remote file URL>
```
Здесь \<remote file URL\> ‒ адрес json-файла на удалённом сервере без указания протокола (без "ftp://"). Пример:

```bash
java -jar app.jar infoteks 12345678 localhost:21/files/students.json
```
В случае проблем с запуском, особенно если вы пытаетесь запустить приложение из графического интерфейса IDE (не рекомендуется),
может помочь добавление разрешения на исполнение:
```bash
chmod +x app.jar
```

Можно запустить клиент, не собирая архив. Для этого выполните скрипт `run.sh`, передав ему те же аргументы командной строки в том же порядке, что и для jar-файла.

После запуска следуйте указаниям консольного интерфейса:

![Screenshot from 2022-09-22 13-26-35](https://user-images.githubusercontent.com/54897530/191723759-9bb7bef8-54bf-454f-92bb-40607a99c4dc.png)

## Запуск тестов
Тесты собраны в jar-файл infoteks-java-qa-eysvald-test-1.0-SNAPSHOT.jar. Для запуска тестов выполните:
```
java -jar infoteks-java-qa-eysvald-test-1.0-SNAPSHOT.jar testng.xml
```
Как и в случае с клиентом, в случае проблем можно попробовать
```bash
chmod +x infoteks-java-qa-eysvald-test-1.0-SNAPSHOT.jar
```

При пересборке тестов командой `mvn package` (требуется Maven) будут загружены зависимости (testNG). Если это запрещено, пользуйтесь уже собранными тестами.

## Описание тестов
Тестовые классы проверяют соответствующие классы бизнес-логики:
* `TestClient` ‒ проверка бизнес-логики. По одному тесту с разными аргументами 
(пустой/непустой список, наличие/отсутствие искомого элемента там, где применимо) 
на метод бизнес-логики.
  1. Проверка формирования списка всех студентов, если есть студенты с одинаковыми именами, отдельно: в вынесенном отдельно
  тесте допустимы несколько вариантов результата, поскольку не регламентируется, в каком порядке по id должны идти студенты с одинаковыми именами.
  2. Для проверки метода добавления студента использовано знание о внутренней структуре метода, поэтому предусмотрены в том числе случаи, когда максимально
  возможный идентификатор студента занят.
* `TestConnection` ‒ проверка соединения с удалённым сервером при распространённых негативных сценариях: 
некорректный формат URL, сервер оффлайн, неверный пароль, файл не найден, нет прав на чтение/запись, 
а также при позитивных сценариях для разных файловых систем.
* `TestIOProcessor` ‒ тестирует первичную обработку команд. Использует тестовую минимальную реализацию интерфейса `CommandRunner` `TestCommandRunner`,
которая не общается с сервером, а возвращает заранее известный ответ.
В первую очередь для этого и был выделен интерфейс. Тесты ‒ кейсы ошибок, которые можно сделать в командах (неверное число аргументов, неверный тип
аргументов, очепятки в командах).
* `TestJSONParser` ‒ проверка парсинга Java-классов из строки и преобразования обратно в строку. Обычно это может не требоваться, но парсинг с помощью 
встроенного Nashorn API ‒ сложная логика, которую лучше проверить. Туда же добавлена проверка того, что `getInstance()` возвращает один и тот же парсер,
будучи вызванным несколько раз (в данном случае скорее формальность, поскольку, будь это разные объекты, ничего бы не изменилось).

## Демо
![Screenshot from 2022-09-22 14-48-19](https://user-images.githubusercontent.com/54897530/191738938-6eb826f6-fef9-4dfa-8586-51af3ba5872a.png)

